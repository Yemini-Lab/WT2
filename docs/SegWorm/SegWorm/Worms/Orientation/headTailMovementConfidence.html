<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of headTailMovementConfidence</title>
  <meta name="keywords" content="headTailMovementConfidence">
  <meta name="description" content="HEADTAILMOVEMENTCONFIDENCE How much confidence do we have in the head and">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- # SegWorm --><!-- # Worms --><!-- menu.html Orientation -->
<h1>headTailMovementConfidence
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>HEADTAILMOVEMENTCONFIDENCE How much confidence do we have in the head and</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [headOrthoConfidence tailOrthoConfidenceheadParaConfidence tailParaConfidenceheadMagConfidence tailMagConfidence] =headTailMovementConfidence(worm1, worm2, varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">HEADTAILMOVEMENTCONFIDENCE How much confidence do we have in the head and
   tail assignment based on their movement in successive frames?

   Note: both frames must share the same worm orientation (see ORIENTWORM).

   [HEADORTHOCONFIDENCE TAILORTHOCONFIDENCE
    HEADPARACONFIDENCE TAILPARACONFIDENCE
    HEADMAGCONFIDENCE TAILMAGCONFIDENCE] =
       HEADTAILMOVEMENTCONFIDENCE(WORM1, WORM2)

   Inputs:
       worm1 - the worm from the first frame
       worm2 - the worm from the successive frame (oriented relative to
               worm1 -- see ORIENTWORM)
       verbose - verbose mode shows the worms in a figure

   Output:
       headOrthoConfidence - how much confidence do we have in the head
                             choice as the worm's head based on its
                             orthogonal (side-to-side) movement in these
                             successive frames? 
       tailOrthoConfidence - how much confidence do we have in the tail
                             choice as the worm's head based on its
                             orthogonal (side-to-side) movement in these
                             successive frames? 
       headParaConfidence  - how much confidence do we have in the head
                             choice as the worm's head based on its
                             parallel (back-to-front) movement in these
                             successive frames? 
       tailParaConfidence  - how much confidence do we have in the tail
                             choice as the worm's head based on its
                             parallel (back-to-front) movement in these
                             successive frames?
       headMagConfidence   - how much confidence do we have in the head
                             choice as the worm's head based on its
                             movement magnitude in these successive
                             frames? 
       tailMagConfidence   - how much confidence do we have in the tail
                             choice as the worm's head based on its
                             movement magnitude in these successive
                             frames? 

   See also SEGWORM, <a href="orientWorm.html" class="code" title="function [worm2 confidence flippedConfidence] =orientWorm(worm1, worm2, samples, varargin)">ORIENTWORM</a>, <a href="orientWormAtCentroid.html" class="code" title="function [worm2 confidence flippedConfidence] =orientWormAtCentroid(worm1, worm2, samples, varargin)">ORIENTWORMATCENTROID</a>, <a href="orientWormPostCoil.html" class="code" title="function worm2 = orientWormPostCoil(worm1, worm2, varargin)">ORIENTWORMPOSTCOIL</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../SegWorm/ComputerVision/chainCodeLengthInterp.html" class="code" title="function [interpData indices] = chainCodeLengthInterp(data, lengths,chainCodeLengths, varargin)">chainCodeLengthInterp</a>	INTERPDATA Interpolate data values at the requested chain-code lengths.</li><li><a href="../../../SegWorm/Worms/Video/overlayWormAngles.html" class="code" title="function oImg = overlayWormAngles(img, worm, cRGB360, sRGB360, sRGBNaN,headPattern, headRGB, isHeadOpaque, vulvaPattern, vulvaRGB, isVulvaOpaque)">overlayWormAngles</a>	OVERLAYWORMANGLES Overlay the worm's contour/skeleton angles (curvature)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../SegWorm/Worms/Features/wormVelocityTest.html" class="code" title="function [velocities centroidVelocities] =wormVelocityTest(wormFile, indices, use, type, scales, isSparse, verbose)">wormVelocityTest</a>	SEGWORMVIDEOFRAMES Segment the worm in a set of video frames and organize</li><li><a href="../../../SegWorm/Worms/Video/segWormFrames.html" class="code" title="function [worms imgs oImgs] = segWormFrames(videoFile, frames, verbose,varargin)">segWormFrames</a>	SEGWORMFRAMES Segment the worm in a set of video frames and organize</li><li><a href="../../../SegWorm/Worms/Video/segWormVideo.html" class="code" title="function failedFrames = segWormVideo(videoFile, anglesVideoFile,touchVideoFile, debugVideoFile, varargin)">segWormVideo</a>	SEGWORMVIDEO Segment a worm video.</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [headOrthoConfidence tailOrthoConfidence </a><span class="keyword">...</span>
0002     headParaConfidence tailParaConfidence <span class="keyword">...</span>
0003     headMagConfidence tailMagConfidence] = <span class="keyword">...</span>
0004     headTailMovementConfidence(worm1, worm2, varargin)
0005 <span class="comment">%HEADTAILMOVEMENTCONFIDENCE How much confidence do we have in the head and</span>
0006 <span class="comment">%   tail assignment based on their movement in successive frames?</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%   Note: both frames must share the same worm orientation (see ORIENTWORM).</span>
0009 <span class="comment">%</span>
0010 <span class="comment">%   [HEADORTHOCONFIDENCE TAILORTHOCONFIDENCE</span>
0011 <span class="comment">%    HEADPARACONFIDENCE TAILPARACONFIDENCE</span>
0012 <span class="comment">%    HEADMAGCONFIDENCE TAILMAGCONFIDENCE] =</span>
0013 <span class="comment">%       HEADTAILMOVEMENTCONFIDENCE(WORM1, WORM2)</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%   Inputs:</span>
0016 <span class="comment">%       worm1 - the worm from the first frame</span>
0017 <span class="comment">%       worm2 - the worm from the successive frame (oriented relative to</span>
0018 <span class="comment">%               worm1 -- see ORIENTWORM)</span>
0019 <span class="comment">%       verbose - verbose mode shows the worms in a figure</span>
0020 <span class="comment">%</span>
0021 <span class="comment">%   Output:</span>
0022 <span class="comment">%       headOrthoConfidence - how much confidence do we have in the head</span>
0023 <span class="comment">%                             choice as the worm's head based on its</span>
0024 <span class="comment">%                             orthogonal (side-to-side) movement in these</span>
0025 <span class="comment">%                             successive frames?</span>
0026 <span class="comment">%       tailOrthoConfidence - how much confidence do we have in the tail</span>
0027 <span class="comment">%                             choice as the worm's head based on its</span>
0028 <span class="comment">%                             orthogonal (side-to-side) movement in these</span>
0029 <span class="comment">%                             successive frames?</span>
0030 <span class="comment">%       headParaConfidence  - how much confidence do we have in the head</span>
0031 <span class="comment">%                             choice as the worm's head based on its</span>
0032 <span class="comment">%                             parallel (back-to-front) movement in these</span>
0033 <span class="comment">%                             successive frames?</span>
0034 <span class="comment">%       tailParaConfidence  - how much confidence do we have in the tail</span>
0035 <span class="comment">%                             choice as the worm's head based on its</span>
0036 <span class="comment">%                             parallel (back-to-front) movement in these</span>
0037 <span class="comment">%                             successive frames?</span>
0038 <span class="comment">%       headMagConfidence   - how much confidence do we have in the head</span>
0039 <span class="comment">%                             choice as the worm's head based on its</span>
0040 <span class="comment">%                             movement magnitude in these successive</span>
0041 <span class="comment">%                             frames?</span>
0042 <span class="comment">%       tailMagConfidence   - how much confidence do we have in the tail</span>
0043 <span class="comment">%                             choice as the worm's head based on its</span>
0044 <span class="comment">%                             movement magnitude in these successive</span>
0045 <span class="comment">%                             frames?</span>
0046 <span class="comment">%</span>
0047 <span class="comment">%   See also SEGWORM, ORIENTWORM, ORIENTWORMATCENTROID, ORIENTWORMPOSTCOIL</span>
0048 
0049 <span class="comment">% Are we in verbose mode?</span>
0050 <span class="keyword">if</span> isempty(varargin)
0051     verbose = false;
0052 <span class="keyword">else</span>
0053     verbose = varargin{1};
0054 <span class="keyword">end</span>
0055 
0056 <span class="comment">% Find 3 points on worm 1's head and tail.</span>
0057 <span class="comment">% Note: the point indices decrease distally from their respective ends.</span>
0058 skeleton1 = worm1.skeleton;
0059 pixels1 = skeleton1.pixels;
0060 ccLengths1 = skeleton1.chainCodeLengths;
0061 head1 = worm1.head;
0062 tail1 = worm1.tail;
0063 hBounds1 = head1.bounds.skeleton;
0064 hPixels1(3,:) = pixels1(hBounds1(1),:);
0065 hPixels1(2,:) = <a href="../../../SegWorm/ComputerVision/chainCodeLengthInterp.html" class="code" title="function [interpData indices] = chainCodeLengthInterp(data, lengths,chainCodeLengths, varargin)">chainCodeLengthInterp</a>(pixels1, <span class="keyword">...</span>
0066     (ccLengths1(hBounds1(1)) + ccLengths1(hBounds1(2))) / 2, ccLengths1);
0067 hPixels1(1,:) = pixels1(hBounds1(2),:);
0068 tBounds1 = tail1.bounds.skeleton;
0069 tPixels1(3,:) = pixels1(tBounds1(2),:);
0070 tPixels1(2,:) = <a href="../../../SegWorm/ComputerVision/chainCodeLengthInterp.html" class="code" title="function [interpData indices] = chainCodeLengthInterp(data, lengths,chainCodeLengths, varargin)">chainCodeLengthInterp</a>(pixels1, <span class="keyword">...</span>
0071     (ccLengths1(tBounds1(1)) + ccLengths1(tBounds1(2))) / 2, ccLengths1);
0072 tPixels1(1,:) = pixels1(tBounds1(1),:);
0073 <span class="keyword">if</span> worm1.orientation.head.isFlipped
0074     tmp = hPixels1;
0075     hPixels1 = tPixels1;
0076     tPixels1 = tmp;
0077 <span class="keyword">end</span>
0078 
0079 <span class="comment">% Compute the origin.</span>
0080 ohVector = mean(diff(hPixels1));
0081 ohAngle = atan2(ohVector(1), ohVector(2));
0082 otVector = mean(diff(tPixels1));
0083 otAngle = atan2(otVector(1), otVector(2));
0084 
0085 <span class="comment">% Find 3 points on worm 2's head and tail.</span>
0086 <span class="comment">% Note: the point indices decrease distally from their respective ends.</span>
0087 skeleton2 = worm2.skeleton;
0088 pixels2 = skeleton2.pixels;
0089 ccLengths2 = skeleton2.chainCodeLengths;
0090 head2 = worm2.head;
0091 tail2 = worm2.tail;
0092 hBounds2 = head2.bounds.skeleton;
0093 hPixels2(3,:) = pixels2(hBounds2(1),:);
0094 hPixels2(2,:) = <a href="../../../SegWorm/ComputerVision/chainCodeLengthInterp.html" class="code" title="function [interpData indices] = chainCodeLengthInterp(data, lengths,chainCodeLengths, varargin)">chainCodeLengthInterp</a>(pixels2, <span class="keyword">...</span>
0095     (ccLengths2(hBounds2(1)) + ccLengths2(hBounds2(2))) / 2, ccLengths2);
0096 hPixels2(1,:) = pixels2(hBounds2(2),:);
0097 tBounds2 = tail2.bounds.skeleton;
0098 tPixels2(3,:) = pixels2(tBounds2(2),:);
0099 tPixels2(2,:) = <a href="../../../SegWorm/ComputerVision/chainCodeLengthInterp.html" class="code" title="function [interpData indices] = chainCodeLengthInterp(data, lengths,chainCodeLengths, varargin)">chainCodeLengthInterp</a>(pixels2, <span class="keyword">...</span>
0100     (ccLengths2(tBounds2(1)) + ccLengths2(tBounds2(2))) / 2, ccLengths2);
0101 tPixels2(1,:) = pixels2(tBounds2(1),:);
0102 <span class="keyword">if</span> worm2.orientation.head.isFlipped
0103     tmp = hPixels2;
0104     hPixels2 = tPixels2;
0105     tPixels2 = tmp;
0106 <span class="keyword">end</span>
0107 
0108 <span class="comment">% Compute the differential.</span>
0109 dhVectors = hPixels2 - hPixels1;
0110 dhAngles = atan2(dhVectors(:,1), dhVectors(:,2));
0111 dtVectors = tPixels2 - tPixels1;
0112 dtAngles = atan2(dtVectors(:,1), dtVectors(:,2));
0113 
0114 <span class="comment">% Compute worm 2's directions relative to worm 1.</span>
0115 hAngles = dhAngles - ohAngle;
0116 wrap = hAngles &gt; pi;
0117 hAngles(wrap) = hAngles(wrap) - 2 * pi;
0118 wrap = hAngles &lt; -pi;
0119 hAngles(wrap) = hAngles(wrap) + 2 * pi;
0120 tAngles = dtAngles - otAngle;
0121 wrap = tAngles &gt; pi;
0122 tAngles(wrap) = tAngles(wrap) - 2 * pi;
0123 wrap = tAngles &lt; -pi;
0124 tAngles(wrap) = tAngles(wrap) + 2 * pi;
0125 
0126 <span class="comment">% Compute the parallel and orthogonal vector components.</span>
0127 dhMags = sqrt(sum(dhVectors .^ 2, 2));
0128 dhOrthos = dhMags .* sin(hAngles);
0129 dhParas = dhMags .* cos(abs(hAngles));
0130 dtMags = sqrt(sum(dtVectors .^ 2, 2));
0131 dtOrthos = dtMags .* sin(tAngles);
0132 dtParas = dtMags .* cos(abs(tAngles));
0133 
0134 <span class="comment">% Compute the head vs. tail confidence.</span>
0135 headOrthoConfidence = abs(mean(dhOrthos));
0136 tailOrthoConfidence = abs(mean(dtOrthos));
0137 headParaConfidence = mean(dhParas);
0138 tailParaConfidence = mean(dtParas);
0139 headMagConfidence = mean(dhMags);
0140 tailMagConfidence = mean(dtMags);
0141 
0142 <span class="comment">% Show the worms.</span>
0143 <span class="keyword">if</span> verbose
0144     
0145     <span class="comment">% Construct a pattern to identify the head.</span>
0146     hImg = [1 1 1 1 1; <span class="keyword">...</span>
0147             1 1 1 1 1; <span class="keyword">...</span>
0148             1 1 1 1 1; <span class="keyword">...</span>
0149             1 1 1 1 1; <span class="keyword">...</span>
0150             1 1 1 1 1];
0151     [hPattern(:,1) hPattern(:,2)] = find(hImg == 1);
0152     hPattern(:,1) = hPattern(:,1) - ceil(size(hImg, 1) / 2);
0153     hPattern(:,2) = hPattern(:,2) - ceil(size(hImg, 2) / 2);
0154     
0155     <span class="comment">% Construct a pattern to identify the vulva.</span>
0156     vImg = [0 0 1 0 0; <span class="keyword">...</span>
0157             0 1 1 1 0; <span class="keyword">...</span>
0158             1 1 1 1 1; <span class="keyword">...</span>
0159             0 1 1 1 0; <span class="keyword">...</span>
0160             0 0 1 0 0];
0161     [vPattern(:,1) vPattern(:,2)] = find(vImg == 1);
0162     vPattern(:,1) = vPattern(:,1) - ceil(size(vImg, 1) / 2);
0163     vPattern(:,2) = vPattern(:,2) - ceil(size(vImg, 2) / 2);
0164     
0165     <span class="comment">% Construct the values for the contour and skeleton curvature heat map.</span>
0166     intensity = .7;
0167     zeros361 = zeros(361, 1);
0168     c361(1:361,1) = intensity;
0169     cRGB = [c361, zeros361, zeros361]; <span class="comment">% red</span>
0170     hRGB = [intensity 0 0]; <span class="comment">% red</span>
0171     vRGB = [intensity 0 0]; <span class="comment">% red</span>
0172     
0173     <span class="comment">% Compute the parallel and orthogonal head pixels.</span>
0174     hParaPixels(:,2) = hPixels1(:,2) + dhParas .* cos(ohAngle);
0175     hParaPixels(:,1) = hPixels1(:,1) + dhParas .* sin(ohAngle);
0176     ohOrthoAngle = ohAngle + pi / 2;
0177     hOrthoPixels(:,2) = hPixels1(:,2) + dhOrthos .* cos(ohOrthoAngle);
0178     hOrthoPixels(:,1) = hPixels1(:,1) + dhOrthos .* sin(ohOrthoAngle);
0179 
0180     <span class="comment">% Compute the parallel and orthogonal tail pixels.</span>
0181     tParaPixels(:,2) = tPixels1(:,2) + dtParas .* cos(otAngle);
0182     tParaPixels(:,1) = tPixels1(:,1) + dtParas .* sin(otAngle);
0183     otOrthoAngle = otAngle + pi / 2;
0184     tOrthoPixels(:,2) = tPixels1(:,2) + dtOrthos .* cos(otOrthoAngle);
0185     tOrthoPixels(:,1) = tPixels1(:,1) + dtOrthos .* sin(otOrthoAngle);
0186     
0187     <span class="comment">% Determine the worms' MER (minimum enclosing rectangle).</span>
0188     <span class="comment">% Note: the skeleton can exit the contour.</span>
0189     wMinX = min(min(worm1.contour.pixels(:,2)), <span class="keyword">...</span>
0190         min(worm1.skeleton.pixels(:,2)));
0191     wMaxX = max(max(worm1.contour.pixels(:,2)), <span class="keyword">...</span>
0192         max(worm1.skeleton.pixels(:,2)));
0193     wMinY = min(min(worm1.contour.pixels(:,1)), <span class="keyword">...</span>
0194         min(worm1.skeleton.pixels(:,1)));
0195     wMaxY = max(max(worm1.contour.pixels(:,1)), <span class="keyword">...</span>
0196         max(worm1.skeleton.pixels(:,1)));
0197     wMinX = min([wMinX, min(worm2.contour.pixels(:,2)), <span class="keyword">...</span>
0198         min(worm2.skeleton.pixels(:,2))]);
0199     wMaxX = max([wMaxX, max(worm2.contour.pixels(:,2)), <span class="keyword">...</span>
0200         max(worm2.skeleton.pixels(:,2))]);
0201     wMinY = min([wMinY, min(worm2.contour.pixels(:,1)), <span class="keyword">...</span>
0202         min(worm2.skeleton.pixels(:,1))]);
0203     wMaxY = max([wMaxY, max(worm2.contour.pixels(:,1)), <span class="keyword">...</span>
0204         max(worm2.skeleton.pixels(:,1))]);
0205     rhParaPixels = round(hParaPixels);
0206     rhOrthoPixels = round(hOrthoPixels);
0207     rtParaPixels = round(tParaPixels);
0208     rtOrthoPixels = round(tOrthoPixels);
0209     wMinX = min([wMinX, min(rhParaPixels(:,2)), min(rhOrthoPixels(:,2)), <span class="keyword">...</span>
0210         min(rtParaPixels(:,2)), min(rtOrthoPixels(:,2))]);
0211     wMaxX = max([wMaxX, max(rhParaPixels(:,2)), max(rhOrthoPixels(:,2)), <span class="keyword">...</span>
0212         max(rtParaPixels(:,2)), max(rtOrthoPixels(:,2))]);
0213     wMinY = min([wMinY, min(rhParaPixels(:,1)), min(rhOrthoPixels(:,1)), <span class="keyword">...</span>
0214         min(rtParaPixels(:,1)), min(rtOrthoPixels(:,1))]);
0215     wMaxY = max([wMaxY, max(rhParaPixels(:,1)), max(rhOrthoPixels(:,1)), <span class="keyword">...</span>
0216         max(rtParaPixels(:,1)), max(rtOrthoPixels(:,1))]);
0217     
0218     <span class="comment">% Minimize the worms.</span>
0219     worm1.contour.pixels(:,1) = worm1.contour.pixels(:,1) - wMinY + 3;
0220     worm1.contour.pixels(:,2) = worm1.contour.pixels(:,2) - wMinX + 3;
0221     worm1.skeleton.pixels(:,1) = worm1.skeleton.pixels(:,1) - wMinY + 3;
0222     worm1.skeleton.pixels(:,2) = worm1.skeleton.pixels(:,2) - wMinX + 3;
0223     worm2.contour.pixels(:,1) = worm2.contour.pixels(:,1) - wMinY + 3;
0224     worm2.contour.pixels(:,2) = worm2.contour.pixels(:,2) - wMinX + 3;
0225     worm2.skeleton.pixels(:,1) = worm2.skeleton.pixels(:,1) - wMinY + 3;
0226     worm2.skeleton.pixels(:,2) = worm2.skeleton.pixels(:,2) - wMinX + 3;
0227     
0228     <span class="comment">% Minimize the head samples.</span>
0229     hPixels1 = round(hPixels1);
0230     hPixels1(:,1) = hPixels1(:,1) - wMinY + 3;
0231     hPixels1(:,2) = hPixels1(:,2) - wMinX + 3;
0232     hPixels2 = round(hPixels2);
0233     hPixels2(:,1) = hPixels2(:,1) - wMinY + 3;
0234     hPixels2(:,2) = hPixels2(:,2) - wMinX + 3;
0235     hParaPixels(:,1) = hParaPixels(:,1) - wMinY + 3;
0236     hParaPixels(:,2) = hParaPixels(:,2) - wMinX + 3;
0237     hOrthoPixels(:,1) = hOrthoPixels(:,1) - wMinY + 3;
0238     hOrthoPixels(:,2) = hOrthoPixels(:,2) - wMinX + 3;
0239     
0240     <span class="comment">% Minimize the tail samples.</span>
0241     tPixels1 = round(tPixels1);
0242     tPixels1(:,1) = tPixels1(:,1) - wMinY + 3;
0243     tPixels1(:,2) = tPixels1(:,2) - wMinX + 3;
0244     tPixels2 = round(tPixels2);
0245     tPixels2(:,1) = tPixels2(:,1) - wMinY + 3;
0246     tPixels2(:,2) = tPixels2(:,2) - wMinX + 3;
0247     tParaPixels(:,1) = tParaPixels(:,1) - wMinY + 3;
0248     tParaPixels(:,2) = tParaPixels(:,2) - wMinX + 3;
0249     tOrthoPixels(:,1) = tOrthoPixels(:,1) - wMinY + 3;
0250     tOrthoPixels(:,2) = tOrthoPixels(:,2) - wMinX + 3;
0251     
0252     <span class="comment">% Construct the worms' images.</span>
0253     emptyImg = ones(wMaxY - wMinY + 5, wMaxX - wMinX + 5);
0254     img1 = <a href="../../../SegWorm/Worms/Video/overlayWormAngles.html" class="code" title="function oImg = overlayWormAngles(img, worm, cRGB360, sRGB360, sRGBNaN,headPattern, headRGB, isHeadOpaque, vulvaPattern, vulvaRGB, isVulvaOpaque)">overlayWormAngles</a>(emptyImg, worm1, cRGB, [], [], <span class="keyword">...</span>
0255         hPattern, hRGB, 1, vPattern, vRGB, 1);
0256     img2 = <a href="../../../SegWorm/Worms/Video/overlayWormAngles.html" class="code" title="function oImg = overlayWormAngles(img, worm, cRGB360, sRGB360, sRGBNaN,headPattern, headRGB, isHeadOpaque, vulvaPattern, vulvaRGB, isVulvaOpaque)">overlayWormAngles</a>(emptyImg, worm2, cRGB, [], [], <span class="keyword">...</span>
0257         hPattern, hRGB, 1, vPattern, vRGB, 1);
0258     
0259     <span class="comment">% Overlay the worm images.</span>
0260     rImg = img2(:,:,1);
0261     gImg = img1(:,:,1);
0262     bImg = rImg;
0263     bImg(gImg == intensity) = intensity;
0264     p1I = sub2ind(size(rImg), [hPixels1(:,1); tPixels1(:,1)], <span class="keyword">...</span>
0265         [hPixels1(:,2); tPixels1(:,2)]);
0266     rImg(p1I) = intensity;
0267     gImg(p1I) = 0;
0268     bImg(p1I) = 0;
0269     p2I = sub2ind(size(gImg), [hPixels2(:,1); tPixels2(:,1)], <span class="keyword">...</span>
0270         [hPixels2(:,2); tPixels2(:,2)]);
0271     rImg(p2I) = 0;
0272     gImg(p2I) = intensity;
0273     bImg(p2I) = 0;
0274     rgbImg(:,:,1) = rImg;
0275     rgbImg(:,:,2) = gImg;
0276     rgbImg(:,:,3) = bImg;
0277     
0278     <span class="comment">% Show the overlay.</span>
0279     figure;
0280     imshow(rgbImg);
0281     title([<span class="string">'\color{darkGreen}Worm 2 (frame = '</span> <span class="keyword">...</span>
0282         num2str(worm2.video.frame) <span class="string">')'</span>]);
0283     ylabel([<span class="string">'\color{red}Worm 1 (frame = '</span> num2str(worm1.video.frame) <span class="string">')'</span>]);
0284     xlabel({[<span class="string">'\color{black}Orthogonal Confidence:'</span> <span class="keyword">...</span>
0285         <span class="string">' Head = '</span> num2str(headOrthoConfidence)  <span class="keyword">...</span>
0286         <span class="string">'   Tail = '</span> num2str(tailOrthoConfidence)],  <span class="keyword">...</span>
0287         [<span class="string">'\color{blue}Parallel Confidence:'</span> <span class="keyword">...</span>
0288         <span class="string">' Head = '</span> num2str(headParaConfidence)  <span class="keyword">...</span>
0289         <span class="string">'   Tail = '</span> num2str(tailParaConfidence)],  <span class="keyword">...</span>
0290         [<span class="string">'\color{orange}Magnitude Confidence:'</span> <span class="keyword">...</span>
0291         <span class="string">' Head = '</span> num2str(headMagConfidence)  <span class="keyword">...</span>
0292         <span class="string">'   Tail = '</span> num2str(tailMagConfidence)]});
0293     
0294     <span class="comment">% Show the vectors.</span>
0295     hold on;
0296     dhParaPixels = hParaPixels - hPixels1;
0297     quiver(hPixels1(:,2), hPixels1(:,1), <span class="keyword">...</span>
0298          dhParaPixels(:,2), dhParaPixels(:,1), 0, <span class="string">'b'</span>);
0299     dhOrthoPixels = hOrthoPixels - hPixels1;
0300     quiver(hPixels1(:,2), hPixels1(:,1), <span class="keyword">...</span>
0301          dhOrthoPixels(:,2), dhOrthoPixels(:,1), 0, <span class="string">'k'</span>);
0302     dtParaPixels = tParaPixels - tPixels1;
0303     quiver(tPixels1(:,2), tPixels1(:,1), <span class="keyword">...</span>
0304          dtParaPixels(:,2), dtParaPixels(:,1), 0, <span class="string">'b'</span>);
0305     dtOrthoPixels = tOrthoPixels - tPixels1;
0306     quiver(tPixels1(:,2), tPixels1(:,1), <span class="keyword">...</span>
0307          dtOrthoPixels(:,2), dtOrthoPixels(:,1), 0, <span class="string">'k'</span>);
0308 <span class="keyword">end</span>
0309 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 25-Jun-2013 14:47:30 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>